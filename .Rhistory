install.packages("R.utils")
install.packages("dplyr")
install.packages("readr")
install.packages("fs")
install.packages("data.table")
install.packages("R.utils")
library(dplyr)
library(readr)
library(fs)
library(data.table)
library("R.utils")
base_url <- "https://datasets.imdbws.com/"
files <- c("title.basics.tsv.gz", "title.ratings.tsv.gz")
out_dir <- "data/imdb"
dir_create(out_dir)
for (f in files) {
dest <- file.path(out_dir, f)
if (!file_exists(dest)) {
download.file(paste0(base_url, f), destfile = dest, mode = "wb", quiet = TRUE)
}
}
basics   <- fread(file.path(out_dir, "title.basics.tsv.gz"),
sep = "\t", na.strings = "\\N", quote = "")
ratings  <- fread(file.path(out_dir, "title.ratings.tsv.gz"),
sep = "\t", na.strings = "\\N", quote = "")
```
base_url <- "https://datasets.imdbws.com/"
files <- c("title.basics.tsv.gz", "title.ratings.tsv.gz")
out_dir <- "data/imdb"
dir_create(out_dir)
for (f in files) {
dest <- file.path(out_dir, f)
if (!file_exists(dest)) {
download.file(paste0(base_url, f), destfile = dest, mode = "wb", quiet = TRUE)
}
}
basics   <- fread(file.path(out_dir, "title.basics.tsv.gz"),
sep = "\t", na.strings = "\\N", quote = "")
ratings  <- fread(file.path(out_dir, "title.ratings.tsv.gz"),
sep = "\t", na.strings = "\\N", quote = "")
summary(ratings)
summary(basics)
str(ratings)
str(basics)
basics$startYear <- as.numeric(basics$startYear)
basics$runtimeMinutes <- as.numeric(basics$runtimeMinutes)
ratings <- ratings %>% select(tconst,averageRating)
basics <- basics %>% select(tconst,titleType,primaryTitle,startYear,runtimeMinutes) %>% filter(titleType =="movie", startYear >= 2011, startYear <= 2020, !is.na(runtimeMinutes))
View(basics)
View(ratings)
summary(ratings)
summary(basics)
str(ratings)
str(basics)
basics$startYear <- as.numeric(basics$startYear)
basics$runtimeMinutes <- as.numeric(basics$runtimeMinutes)
ratings <- ratings %>% select(tconst,averageRating,numVotes)
base_url <- "https://datasets.imdbws.com/"
files <- c("title.basics.tsv.gz", "title.ratings.tsv.gz")
out_dir <- "data/imdb"
dir_create(out_dir)
for (f in files) {
dest <- file.path(out_dir, f)
if (!file_exists(dest)) {
download.file(paste0(base_url, f), destfile = dest, mode = "wb", quiet = TRUE)
}
}
basics   <- fread(file.path(out_dir, "title.basics.tsv.gz"),
sep = "\t", na.strings = "\\N", quote = "")
ratings  <- fread(file.path(out_dir, "title.ratings.tsv.gz"),
sep = "\t", na.strings = "\\N", quote = "")
summary(ratings)
summary(basics)
str(ratings)
str(basics)
basics$startYear <- as.numeric(basics$startYear)
basics$runtimeMinutes <- as.numeric(basics$runtimeMinutes)
ratings <- ratings %>% select(tconst,averageRating,numVotes)
basics <- basics %>% select(tconst,titleType,primaryTitle,startYear,runtimeMinutes, genres) %>% filter(titleType =="movie", startYear >= 2011, startYear <= 2020, !is.na(runtimeMinutes))
merged_df <- merge(basics, ratings, by = "tconst")
View(merged_df)
