rowwise() %>%
mutate(
political_trust = mean(c_across(all_of(political_items)), na.rm=TRUE), # politiek vertrouwen
rule_of_law_trust = mean(c_across(all_of(rule_of_law_items)), na.rm=TRUE), # rechtssysteem/politie
social_institution_trust = mean(c_across(all_of(social_items)), na.rm=TRUE), # sociale instituties
trust_in_institutions = mean(c_across(all_of(all_items)), na.rm=TRUE) # totaal vertrouwen
) %>%
ungroup()
pol_val1 <- X8_Politics_and_Values %>%
select(
nomem_encr,
year_month,
`8.001`,
`8.013`, `8.014`, `8.015`,`8.016`,`8.017`,`8.018`,`8.019`,`8.020`,
`8.021`,`8.022`,`8.023`,`8.024`,`8.025`,`8.026`,`8.027`,`8.030`,
`8.031`,`8.032`,`8.033`,`8.034`,`8.035`,`8.036`,`8.037`,`8.038`,
`8.039`,`8.040`,`8.041`,`8.042`,`8.043`,`8.044`,`8.047`,`8.048`,
`8.049`
) %>%
rename(yearmonth = year_month)
# Groepen items voor betrouwbaarheidsanalyse
political_items <- c("8.013","8.014","8.017","8.018","8.019","8.020","8.027")
rule_of_law_items <- c("8.015","8.016")
social_items <- c("8.021","8.022","8.023","8.024","8.025","8.026")
all_items <- c(political_items, rule_of_law_items, social_items)
# 3. Cronbach's alpha check
# --------------------------
alpha(pol_val1[, political_items])     # politiek vertrouwen
alpha(pol_val1[, rule_of_law_items])   # rechtssysteem/politie
alpha(pol_val1[, social_items])        # sociale instituties
alpha(pol_val1[, all_items])           # totaal vertrouwen
# sla het resultaat op
a_pol <- alpha(pol_val1[, political_items])
a_soc <- alpha(pol_val1[, social_items])
a_all <- alpha(pol_val1[, all_items])
# print alleen Cronbach's alpha
a_pol$total$raw_alpha
a_soc$total$raw_alpha
a_all$total$raw_alpha
# Samengestelde variabelen
pol_val1 <- pol_val1 %>%
rowwise() %>%
mutate(
political_trust = mean(c_across(all_of(political_items)), na.rm=TRUE), # politiek vertrouwen
rule_of_law_trust = mean(c_across(all_of(rule_of_law_items)), na.rm=TRUE), # rechtssysteem/politie
social_institution_trust = mean(c_across(all_of(social_items)), na.rm=TRUE), # sociale instituties
trust_in_institutions = mean(c_across(all_of(all_items)), na.rm=TRUE) # totaal vertrouwen
) %>%
ungroup()
pol_val1 <- pol_val1 %>%
select(
-all_of(paste0("8.", sprintf("%03d", 13:27))),
-all_of(paste0("8.", sprintf("%03d", 30:44))),
-all_of(paste0("8.", sprintf("%03d", 47:49)))
)
cor(pol_val1$`8.015`, pol_val1$`8.016`, use = "pairwise.complete.obs")
pol_val1 <- X8_Politics_and_Values %>%
select(
nomem_encr,
year_month,
`8.001`,
`8.013`, `8.014`, `8.015`,`8.016`,`8.017`,`8.018`,`8.019`,`8.020`,
`8.021`,`8.022`,`8.023`,`8.024`,`8.025`,`8.026`,`8.027`,`8.030`,
`8.031`,`8.032`,`8.033`,`8.034`,`8.035`,`8.036`,`8.037`,`8.038`,
`8.039`,`8.040`,`8.041`,`8.042`,`8.043`,`8.044`,`8.047`,`8.048`,
`8.049`
) %>%
rename(yearmonth = year_month)
pol_val1 <- pol_val1 %>%
mutate(across(everything(), ~na_if(., -9)))
pol_val1 <- pol_val1 %>%
mutate(across(everything(), ~na_if(., 999)))
# Groepen items voor betrouwbaarheidsanalyse
political_items <- c("8.013","8.014","8.017","8.018","8.019","8.020","8.027")
rule_of_law_items <- c("8.015","8.016")
social_items <- c("8.021","8.022","8.023","8.024","8.025","8.026")
all_items <- c(political_items, rule_of_law_items, social_items)
# 3. Cronbach's alpha check
# --------------------------
alpha(pol_val1[, political_items])     # politiek vertrouwen
alpha(pol_val1[, rule_of_law_items])   # rechtssysteem/politie
alpha(pol_val1[, social_items])        # sociale instituties
alpha(pol_val1[, all_items])           # totaal vertrouwen
# sla het resultaat op
a_pol <- alpha(pol_val1[, political_items])
a_soc <- alpha(pol_val1[, social_items])
a_all <- alpha(pol_val1[, all_items])
# print alleen Cronbach's alpha
a_pol$total$raw_alpha
a_soc$total$raw_alpha
a_all$total$raw_alpha
cor(pol_val1$`8.015`, pol_val1$`8.016`, use = "pairwise.complete.obs")
View(pol_val1)
pol_val1 <- pol_val1 %>%
select(
-all_of(paste0("8.", sprintf("%03d", 13:27))),
-all_of(paste0("8.", sprintf("%03d", 30:44))),
-all_of(paste0("8.", sprintf("%03d", 47:49)))
)
library(readr)
X3_Religion_and_Ethnicity <- read_csv("3. Religion and Ethnicity.csv")
View(X3_Religion_and_Ethnicity)
library(dplyr)
library(writexl)
library(psych)
rel_eth1 <- X3_Religion_and_Ethnicity %>%
select(
nomem_encr,
`3._yearmonth`,
`3.143`, `3.144`, `3.162`, `3.164`,
`3.165`:`3.179`
) %>%
rename(yearmonth = `3._yearmonth`) %>%
mutate(
# Religieuze groepen (categorisch)
religion_group = case_when(
`3.144` == 1 ~ "Roman Catholic",
`3.144` %in% c(2,3,4,5,6,7) ~ "Protestant",
`3.144` == 10 ~ "Islam",
`3.144` %in% c(8,9,11,12,13,14) ~ "Other"
),
# Lidmaatschap religieuze groep (dummy 0/1)
member_religious_group = ifelse(`3.143` == 1, 1, 0),
# Externe religieuze perceptie (numeric schaal)
ext_rel_per = as.numeric(`3.162`),
# Zich Nederlands voelen (numeric schaal)
feel_dutch = as.numeric(`3.164`),
# Etniciteit (categorisch, groepen samengevoegd)
ethnic_group = case_when(
`3.165` == 1 ~ "Nederlander",   # No other group
`3.166` == 1 | `3.167` == 1 ~ "Turkije",   # Turks + Koerdisch
`3.168` == 1 | `3.169` == 1 ~ "Marokko",   # Marokkaans + Berbers
`3.170` == 1 | `3.171` == 1 | `3.172` == 1 | `3.173` == 1 ~ "Suriname",  # Surinaams + Hindostaans + Creools + Javaans
`3.175` == 1 | `3.176` == 1 | `3.177` == 1 ~ "Nederlandse Cariben",     # Curaçao, Aruba, Antillen
`3.178` == 1 ~ "Indonesië",     # Indonesië
`3.174` == 1 | `3.179` == 1 ~ "Overig",  # Chinees + Overige groep
TRUE ~ NA_character_
)
) %>%
select(-`3.143`, -`3.144`, -(which(names(.) == "3.165"):which(names(.) == "3.179"))) %>%
mutate(
religion_group = factor(religion_group),
member_religious_group = as.numeric(member_religious_group),
ethnic_group = factor(ethnic_group)
)
library(readr)
X6_Work_and_Schooling <- read_csv("6. Work and Schooling.csv")
View(X6_Work_and_Schooling)
wor_sch1 <- X6_Work_and_Schooling %>%
select(nomem_encr, `6._yearmonth`, `6.001`, `6.005`) %>%
rename(yearmonth = `6._yearmonth`) %>%
mutate(
# Opleidingsniveaus samengevoegd
edu_group = case_when(
`6.005` %in% 1:11 ~ "Low",                  # geen, basis, lager beroepsonderwijs, mavo/vmbo, mms
`6.005` %in% c(12:15, 16:18, 29) ~ "Medium", # havo, vwo, gymnasium, mbo
`6.005` %in% 19:27 ~ "High",                # hbo, wo bachelor/master, PhD
`6.005` == 28 ~ "Other"                     # overige
),
# Betaald werk (dummy 0/1)
paid_work = as.numeric(`6.001`)
) %>%
select(-`6.005`) %>%
mutate(edu_group = factor(edu_group))
View(wor_sch1)
library(readr)
X8_Politics_and_Values <- read_csv("8. Politics and Values.csv")
View(X8_Politics_and_Values)
pol_val1 <- X8_Politics_and_Values %>%
select(
nomem_encr,
year_month,
`8.001`,
`8.013`, `8.014`, `8.015`,`8.016`,`8.017`,`8.018`,`8.019`,`8.020`,
`8.021`,`8.022`,`8.023`,`8.024`,`8.025`,`8.026`,`8.027`,`8.030`,
`8.031`,`8.032`,`8.033`,`8.034`,`8.035`,`8.036`,`8.037`,`8.038`,
`8.039`,`8.040`,`8.041`,`8.042`,`8.043`,`8.044`,`8.047`,`8.048`,
`8.049`
) %>%
rename(yearmonth = year_month)
pol_val1 <- pol_val1 %>%
mutate(across(everything(), ~na_if(., -9)))
pol_val1 <- pol_val1 %>%
mutate(across(everything(), ~na_if(., 999)))
# Groepen items voor betrouwbaarheidsanalyse
political_items <- c("8.013","8.014","8.017","8.018","8.019","8.020","8.027")
rule_of_law_items <- c("8.015","8.016")
social_items <- c("8.021","8.022","8.023","8.024","8.025","8.026")
all_items <- c(political_items, rule_of_law_items, social_items)
# 3. Cronbach's alpha check
# --------------------------
alpha(pol_val1[, political_items])     # politiek vertrouwen
alpha(pol_val1[, rule_of_law_items])   # rechtssysteem/politie
alpha(pol_val1[, social_items])        # sociale instituties
alpha(pol_val1[, all_items])           # totaal vertrouwen
# sla het resultaat op
a_pol <- alpha(pol_val1[, political_items])
a_soc <- alpha(pol_val1[, social_items])
a_all <- alpha(pol_val1[, all_items])
# print alleen Cronbach's alpha
a_pol$total$raw_alpha
a_soc$total$raw_alpha
a_all$total$raw_alpha
cor(pol_val1$`8.015`, pol_val1$`8.016`, use = "pairwise.complete.obs")
# Samengestelde variabelen
pol_val1 <- pol_val1 %>%
rowwise() %>%
mutate(
political_trust = mean(c_across(all_of(political_items)), na.rm=TRUE), # politiek vertrouwen
rule_of_law_trust = mean(c_across(all_of(rule_of_law_items)), na.rm=TRUE), # rechtssysteem/politie
social_institution_trust = mean(c_across(all_of(social_items)), na.rm=TRUE), # sociale instituties
trust_in_institutions = mean(c_across(all_of(all_items)), na.rm=TRUE) # totaal vertrouwen
) %>%
ungroup()
View(pol_val1)
library(readr)
X9_Economic_Situation_Assets <- read_csv("9. Economic Situation - Assets.csv")
View(X9_Economic_Situation_Assets)
eco_ass <- X9_Economic_Situation_Assets
eco_ass1 <- eco_ass %>%
select(
nomem_encr,
`9._yearmonth`,
`9.023`, `9.005`, `9.006`, `9.007`, `9.008`,
`9.009`, `9.010`, `9.011`, `9.012`, `9.013`,
`9.016`, `9.017`, `9.063`, `9.078`
) %>%
rename(yearmonth = `9._yearmonth`) %>%
mutate(
# dummy’s
has_insurance  = ifelse(`9.005` == 1, 1, 0),
has_investment = ifelse(`9.006` == 1, 1, 0),
has_realestate = ifelse(`9.007` == 1, 1, 0),
has_vehicle    = ifelse(`9.008` == 1, 1, 0),
has_none       = ifelse(`9.009` == 1, 1, 0),
has_loans_out  = ifelse(`9.010` == 1, 1, ifelse(`9.010` == 2, 0, NA)),
has_other      = ifelse(`9.011` == 1, 1, ifelse(`9.011` == 2, 0, NA)),
has_bank       = ifelse(`9.078` == 1, 1, 0),
# waarden opschonen
bank_balance = case_when(
`9.012` %in% c(-8, -9, -99999999998, -99999999999,
99999999998, 99999999999) ~ NA_real_,
`9.012` > 1e7 ~ NA_real_,
TRUE ~ as.numeric(`9.012`)
),
investment_value = case_when(
`9.016` %in% c(-8, -9, -9999999998, -9999999999,
99999999998, 99999999999) ~ NA_real_,
`9.016` > 5e6 ~ NA_real_,
TRUE ~ as.numeric(`9.016`)
),
vehicle_value = case_when(
`9.023` %in% c(-8, -9, 99999999998, 99999999999) ~ NA_real_,
`9.023` > 5e5 ~ NA_real_,
TRUE ~ as.numeric(`9.023`)
),
total_debt = case_when(
`9.063` %in% c(-8, -9, 99999999998, 99999999999) ~ NA_real_,
`9.063` > 5e6 ~ NA_real_,
TRUE ~ as.numeric(`9.063`)
),
# categorische variabelen
`9.013` = ifelse(`9.013` == 999, NA, `9.013`),
`9.017` = ifelse(`9.017` == 999, NA, `9.017`),
# Bank categorie
bank_balance_cat = case_when(
bank_balance >= 0     & bank_balance < 50      ~ 1,
bank_balance >= 50    & bank_balance < 250     ~ 2,
bank_balance >= 250   & bank_balance < 500     ~ 3,
bank_balance >= 500   & bank_balance < 750     ~ 4,
bank_balance >= 750   & bank_balance < 1000    ~ 5,
bank_balance >= 1000  & bank_balance < 2500    ~ 6,
bank_balance >= 2500  & bank_balance < 5000    ~ 7,
bank_balance >= 5000  & bank_balance < 7500    ~ 8,
bank_balance >= 7500  & bank_balance < 10000   ~ 9,
bank_balance >= 10000 & bank_balance < 11500   ~ 10,
bank_balance >= 11500 & bank_balance < 14000   ~ 11,
bank_balance >= 14000 & bank_balance < 17000   ~ 12,
bank_balance >= 17000 & bank_balance < 20000   ~ 13,
bank_balance >= 20000 & bank_balance < 25000   ~ 14,
bank_balance >= 25000                          ~ 15,
TRUE ~ NA_real_
),
bank_balance_cat = ifelse(is.na(bank_balance_cat), `9.013`, bank_balance_cat),
# Belegging categorie
investment_cat = case_when(
investment_value >= 0     & investment_value < 500     ~ 1,
investment_value >= 500   & investment_value < 1500    ~ 2,
investment_value >= 1500  & investment_value < 2500    ~ 3,
investment_value >= 2500  & investment_value < 5000    ~ 4,
investment_value >= 5000  & investment_value < 7500    ~ 5,
investment_value >= 7500  & investment_value < 10000   ~ 6,
investment_value >= 10000 & investment_value < 12000   ~ 7,
investment_value >= 12000 & investment_value < 15000   ~ 8,
investment_value >= 15000 & investment_value < 20000   ~ 9,
investment_value >= 20000 & investment_value < 25000   ~ 10,
investment_value >= 25000 & investment_value < 50000   ~ 11,
investment_value >= 50000 & investment_value < 75000   ~ 12,
investment_value >= 75000 & investment_value < 100000  ~ 13,
investment_value >= 100000                            ~ 14,
TRUE ~ NA_real_
),
investment_cat = ifelse(is.na(investment_cat), `9.017`, investment_cat),
vehicle_value_cat = case_when(
vehicle_value >= 0 & vehicle_value < 5000   ~ 1,
vehicle_value >= 5000 & vehicle_value < 15000 ~ 2,
vehicle_value >= 15000 & vehicle_value < 30000 ~ 3,
vehicle_value >= 30000 ~ 4,
TRUE ~ NA_real_
),
debt_cat = case_when(
total_debt >= 0 & total_debt < 5000   ~ 1,
total_debt >= 5000 & total_debt < 20000 ~ 2,
total_debt >= 20000 & total_debt < 50000 ~ 3,
total_debt >= 50000 ~ 4,
TRUE ~ NA_real_
),
# netto vermogen
total_assets = rowSums(across(c(bank_balance, investment_value, vehicle_value)), na.rm = TRUE),
net_worth = total_assets - total_debt,
net_worth_cat = case_when(
net_worth < 0 ~ 1, # negatief
net_worth >= 0 & net_worth < 10000 ~ 2, # laag
net_worth >= 10000 & net_worth < 50000 ~ 3, # midden
net_worth >= 50000 ~ 4,  # hoog
TRUE ~ NA_real_
)
) %>%
select(-c(`9.005`, `9.006`, `9.007`, `9.008`, `9.009`,
`9.010`, `9.011`, `9.012`, `9.013`,
`9.016`, `9.017`, `9.023`, `9.063`, `9.078`))
library(readr)
X10_Economic_Situation_Income <- read_csv("10. Economic Situation - Income.csv")
View(X10_Economic_Situation_Income)
eco_inc <- X10_Economic_Situation_Income
eco_inc1 <- eco_inc %>%
select(
nomem_encr,
Monthyear,
`10.006`, `10.007`, `10.152`, `10.153`,
`10.171`, `10.172`, `10.173`, `10.174`,
`10.339`, `10.229`, `10.378`
) %>%
rename(yearmonth = Monthyear) %>%
mutate(
fin_satisfaction   = ifelse(`10.006` %in% c(-9), NA, as.numeric(`10.006`)),
econ_satisfaction  = ifelse(`10.007` %in% c(-9), NA, as.numeric(`10.007`)),
income_difficulty  = ifelse(`10.378` %in% c(-9), NA, as.numeric(`10.378`)),
has_investment_income = ifelse(`10.152` == 1, 1, 0),
has_interest_income   = ifelse(`10.153` == 1, 1, 0),
investment_income_cat_combined = case_when(
`10.171` %in% c(-8, -9) ~ NA_real_,
`10.171` > 999999999 ~ NA_real_,
!is.na(`10.171`) & `10.171` < 1000   ~ 1,
!is.na(`10.171`) & `10.171` < 3000   ~ 2,
!is.na(`10.171`) & `10.171` < 6000   ~ 3,
!is.na(`10.171`) & `10.171` < 12000  ~ 4,
!is.na(`10.171`) & `10.171` < 30000  ~ 5,
!is.na(`10.171`) & `10.171` < 60000  ~ 6,
!is.na(`10.171`) & `10.171` >= 60000 ~ 7,
is.na(`10.171`) & `10.172` %in% 1:7 ~ as.numeric(`10.172`),
TRUE ~ NA_real_
),
interest_income_cat_combined = case_when(
`10.173` %in% c(-8, -9) ~ NA_real_,
`10.173` > 999999999 ~ NA_real_,
!is.na(`10.173`) & `10.173` < 1000   ~ 1,
!is.na(`10.173`) & `10.173` < 3000   ~ 2,
!is.na(`10.173`) & `10.173` < 6000   ~ 3,
!is.na(`10.173`) & `10.173` < 12000  ~ 4,
!is.na(`10.173`) & `10.173` < 30000  ~ 5,
!is.na(`10.173`) & `10.173` < 60000  ~ 6,
!is.na(`10.173`) & `10.173` >= 60000 ~ 7,
is.na(`10.173`) & `10.174` %in% 1:7 ~ as.numeric(`10.174`),
TRUE ~ NA_real_
),
household_income_cat_combined = case_when(
`10.339` %in% c(-8, -9) ~ NA_real_,
abs(`10.339`) > 999999999 ~ NA_real_,
!is.na(`10.339`) & `10.339` < 8000    ~ 1,
!is.na(`10.339`) & `10.339` < 16000   ~ 2,
!is.na(`10.339`) & `10.339` < 24000   ~ 3,
!is.na(`10.339`) & `10.339` < 36000   ~ 4,
!is.na(`10.339`) & `10.339` < 48000   ~ 5,
!is.na(`10.339`) & `10.339` < 60000   ~ 6,
!is.na(`10.339`) & `10.339` >= 60000  ~ 7,
is.na(`10.339`) & `10.229` %in% 1:7 ~ as.numeric(`10.229`),
TRUE ~ NA_real_
)) %>%
select(-c(`10.006`, `10.007`, `10.152`, `10.153`,
`10.171`, `10.172`, `10.173`, `10.174`,
`10.339`, `10.229`, `10.378`))
library(readr)
X1_Background_variables <- read_csv("1. Background variables.csv")
View(X1_Background_variables)
eco_bg1 <- X1_Background_variables %>%
rename(yearmonth = Monthyear) %>%
mutate(
# Geslacht (1=man, 2=vrouw, 3=anders)
geslacht = factor(geslacht,
levels = c(1, 2, 3),
labels = c("Male", "Female", "Other")),
# Positie in huishouden (1–7 geldig, 9 = NA)
positie = ifelse(positie == 9, NA, positie),
# Leeftijd (check outliers)
leeftijd = ifelse(leeftijd < 0 | leeftijd > 100, NA, leeftijd),
# Huishoudgrootte en aantal kinderen (0–9 geldig)
aantalhh = ifelse(aantalhh %in% 1:9, aantalhh, NA),
aantalki = ifelse(aantalki %in% 0:9, aantalki, NA),
# Burgerlijke staat (1–5 geldig)
burgstat = ifelse(burgstat %in% 1:5, burgstat, NA),
# Woonvorm (1–5 geldig)
woonvorm = ifelse(woonvorm %in% 1:5, woonvorm, NA),
# Woningtype (1–4 geldig, 9 = NA)
woning = ifelse(woning == 9, NA, woning),
# Primaire bezigheid (1–14 geldig)
belbezig = ifelse(belbezig %in% 1:14, belbezig, NA),
# Persoonlijk netto inkomen (nettoink) -13/-14/-15 → NA
nettoink = ifelse(nettoink %in% c(-13, -14, -15), NA, nettoink),
# Persoonlijk inkomen categorie (nettocat) 0–12 geldig, 13/14 = NA
nettocat = ifelse(nettocat %in% 0:12, nettocat, NA),
# Netto huishoudinkomen (nettohh_f) Outliers weghalen (<0 of >100.000 p.m.)
nettohh_f = ifelse(nettohh_f < 0 | nettohh_f > 100000, NA, nettohh_f),
# Opleidingsniveau (1–6 geldig)
oplcat = ifelse(oplcat %in% 1:6, oplcat, NA),
# Herkomstgroep 1=Nederlands, 101/201=Westers, 102/202=Niet-westers, 999=NA
herkomstgroep = case_when(
herkomstgroep == 1 ~ "Dutch",
herkomstgroep %in% c(101, 201) ~ "Western",
herkomstgroep %in% c(102, 202) ~ "Non-western",
TRUE ~ NA_character_
)
) %>%
mutate(
positie = factor(positie),
burgstat = factor(burgstat),
woonvorm = factor(woonvorm),
woning = factor(woning),
belbezig = factor(belbezig),
nettocat = factor(nettocat),
oplcat = factor(oplcat),
herkomstgroep = factor(herkomstgroep)
)
View(eco_inc1)
library(purrr)
datasets <- list(rel_eth1, wor_sch1, pol_val1, eco_ass1, eco_inc1, eco_bg1)
# Merge alles op nomem_encr + yearmonth
merged_data <- reduce(datasets, full_join, by = c("nomem_encr", "yearmonth"))
View(merged_data)
write_csv(merged_data, "merged_dataset.csv")
colSums(is.na(merged_data))
sapply(merged_data, function(x) mean(is.na(x)))
library(MissMech)
num_vars <- merged_data %>% select(where(is.numeric))
mcar_test <- TestMCARNormality(num_vars)
num_vars <- merged_data %>% select(where(is.numeric))
num_vars_sub <- num_vars %>% sample_n(50000)
mcar_test <- TestMCARNormality(num_vars_sub)
print(mcar_test)
summary(merged_data)
summary(merged_data)
merged_data1 <- merged_data %>%
filter(!if_all(-c(nomem_encr, yearmonth), is.na))
datasets <- list(rel_eth1, wor_sch1, pol_val1, eco_ass1, eco_inc1)
# Merge alles op nomem_encr + yearmonth
merged_data <- reduce(datasets, full_join, by = c("nomem_encr", "yearmonth"))
merged_data1 <- merged_data %>% filter(!if_all(-c(nomem_encr, yearmonth), is.na))
View(merged_data1)
main_data <- rel_eth1 %>%
full_join(wor_sch1,   by = c("nomem_encr", "yearmonth")) %>%
full_join(pol_val1,   by = c("nomem_encr", "yearmonth")) %>%
full_join(eco_ass1,   by = c("nomem_encr", "yearmonth")) %>%
full_join(eco_inc1,   by = c("nomem_encr", "yearmonth"))
library(naniar)
library(VIM)
install.packages("VIM")
library(VIM)
# 1a. Totaal aantal NA's per variabele
colSums(is.na(main_data))
# 1b. Proportie NA's per variabele
sapply(main_data, function(x) mean(is.na(x)))
# 1c. Visualisatie: heatmap van missings
vis_miss(main_data)
# 1d. Proportie NA per variabele (handig voor grafiek)
gg_miss_var(main_data)
# 1e. Patronen van gezamenlijke missings
gg_miss_upset(main_data)
# 1f. Alternatief overzicht met percentages en patronen
aggr_plot <- aggr(main_data,
numbers = TRUE,
sortVars = TRUE,
labels = names(main_data),
cex.axis = .7,
gap = 3,
ylab = c("Missing data","Pattern"))
# -------------------------------
# 2. Testen op MCAR
# -------------------------------
library(MissMech)
# 2a. Selecteer alleen numerieke kolommen
num_vars <- main_data %>% select(where(is.numeric))
# 2b. Random subset om singulariteit te vermijden
set.seed(123)
num_vars_sub <- num_vars %>% select(sample(names(num_vars), 10))
# 2c. Run MCAR test
mcar_test <- TestMCARNormality(num_vars_sub)
View(main_data)
main_data <- main_data %>%
filter(!if_all(-c(nomem_encr, yearmonth), is.na))
row_missing <- rowSums(is.na(main_data))
row_missing_prop <- row_missing / ncol(main_data)
summary(row_missing_prop)
